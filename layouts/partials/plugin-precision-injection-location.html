{{- /* 

This partial expects a dictionary as its parameter.

keys:

'location': A key in the config data file with a slice of files to inject.

            For example:
            
            [InjectionLocations]
            HEAD_TOP = [ "google-tag-manager-head-script.html" ]
            ABOVE_HEADER = [ "google-tag-manager-header-script.html" ]
            BELOW_HEADER = []
            FOOTER = []
            BELOW_FOOTER = []
            DEFAULT = [
              "glightbox-injection.html",
              "prism-injection.html",
              "favicons.html",
              "plausible-analytics-script.html",
              "structured-data-injection.html",
              "webmention-links.html",
              "category-cloud-style.html",
              "twitter-open-graph-cards.html",
              "head/social-media-links.html"
              ]

              If an empty string is passed the plugin will check for a default
              location set in the data file as DefaultLocation. Failing that
              the plugin will check for an entry under DEFAULT.
  
  
'context': The page context partials expect to receive (usually a '.').

*/}}

{{- $config := site.Data.plugin_precision_injection_config | default site.Data.plugin_precision_injection.config -}}
{{- $default_location := $config.DefaultLocation | default "DEFAULT" -}}
{{- $location_map := $config.InjectionLocations | default dict -}}

{{- /* Capture the context */}}
{{- $context := .context -}}

{{- /* Check whether a location has been provided  */}}
{{- with (.location | default $default_location) -}}

  {{- /* Check for an entry for location */ -}}
  {{- with (index $location_map .) -}}

    {{- if (reflect.IsSlice .) -}}
  
      {{- /* Iterate the list */ -}}
      {{- range $partial := . -}}
        
        {{- $params := dict "partial" $partial "context" $context -}}
        {{- partial "inject-html-maybe.html" $params -}}
          
      {{- end -}}
      
    {{- end -}}
  
  {{- end -}}
     
{{- end -}}